from flask import render_template
from app import app
import pymysql as mdb
from flask.json import jsonify

from flask import render_template, flash, redirect, url_for
from app import app
#import forms
#from forms import LoginForm
from flask import request
import MySQLdb
import sys
import numpy
import json
import scipy.stats




db = mdb.connect(user="root", host="localhost", db="world_innod", charset='utf8')

@app.route('/')
@app.route('/index')
def index():
	#return render_template("index.html",
	return render_template("index_js.html",
        title = 'Home', user = { 'nickname': 'Miguel' },
        )

@app.route('/map3')
def map3():
	#return render_template("index.html",
	return render_template("map3.html",
        title = 'Home', user = { 'nickname': 'Miguel' },
        )

@app.route('/port')
def port():
	#return render_template("index.html",
	return render_template("portfolio.html",
        title = 'Home', user = { 'nickname': 'Miguel' },
        )



#@app.route('/login')
#def login():
#	return render_template("login.html",
#        title = 'Home', user = { 'nickname': 'Miguel' },
#        )


@app.route('/index2')
def index2():
	#return render_template("index.html",
	return render_template("index2.html",
        title = 'Home', user = { 'nickname': 'Miguel' },
        )


@app.route('/db')
def cities_page():
	with db: 
		cur = db.cursor()
		cur.execute("SELECT Name FROM City LIMIT 15;")
		query_results = cur.fetchall()
	cities = ""
	for result in query_results:
		cities += result[0]
		cities += "<br>"
	return cities
      
      
@app.route("/db_fancy")
def cities_page_fancy():
	with db:
		cur = db.cursor()
		cur.execute("SELECT Name, CountryCode,Population FROM City ORDER BY Population LIMIT 15;")

		query_results = cur.fetchall()
	cities = []
	for result in query_results:
		cities.append(dict(name=result[0], country=result[1], population=result[2]))
	return render_template('cities.html', cities=cities)       
      
      
      
      
@app.route('/map')
def maps():
	return render_template("map.html",title = 'Home', user = { 'nickname': 'Miguel' },
        )



@app.route('/map2')
def maps2():
	return render_template("map2.html",title = 'Home', user = { 'nickname': 'Miguel' },
        )





@app.route("/db_json")
def cities_json():
    with db:
        cur = db.cursor()
        cur.execute("SELECT Name, CountryCode, Population FROM City ORDER BY Population DESC;")
        query_results = cur.fetchall()
    cities = []
    for result in query_results:
        cities.append(dict(name=result[0], country=result[1], population=result[2]))
    return jsonify(dict(cities=cities))
